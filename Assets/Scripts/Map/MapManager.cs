using System;using System.Collections.Generic;using UnityEngine;public class MapManager:MonoBehaviour{	private MapNet net;	private Dictionary<Location, Texture2D> mapCache;	private Texture2D curTexture;	public void Awake() {		net = new MapNet ();		mapCache = new Dictionary<Location, Texture2D> ();	}	public void RequestMap(float lng, float lat) {		GameObject obj = GameObject.FindGameObjectWithTag ("WorldMap");		if (obj == null) {			Debug.Log("Can't find WorldMap Obj");			return ;		}		Location loc = new Location (lng, lat);		switch (findMapInCache (loc)) {		case 1:	//texture is in cache, draw it			obj.renderer.material.mainTexture = curTexture;			break;		case 2:	//texture is not in cache, start coroutine to download			StartCoroutine(net.DownloadMapTexture (loc, obj, mapCache));			break;		default://texture is downloading, nothing to do			Debug.Log("Texture is downloading:"+loc.toString());			break;		}	}	private int findMapInCache(Location loc) {		foreach (Location other in mapCache.Keys) {			if (loc.GetDistance(other) < 1.5f ) {				if(mapCache[other] == null || mapCache[other] == curTexture)					return 3;				else {					curTexture= mapCache[other];					return 1;				}			}		}		mapCache.Add(loc,null);		curTexture = null;		return 2;	}}