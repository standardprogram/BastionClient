using UnityEngine;using System.Collections;using LitJson;public class GameManager : MonoBehaviour {	GameObject gm;	public enum GameScene {		SCENE_INIT,		SCENE_LOADING,		SCENE_BASTION,		SCENE_WORLDMAP,		SCENE_BATTLE,	};	// Use this for initialization	void Start () {		gm = GameObject.FindGameObjectWithTag ("GameManager");		GameObject.DontDestroyOnLoad (gm);		gm.AddComponent<InitScene>();	}		// Update is called once per frame	void Update () {		if (Input.GetKey (KeyCode.Escape)) {			Application.Quit ();		}		}	public void LoadScene(GameScene scene) {		switch (scene) {		case GameScene.SCENE_LOADING:			Application.LoadLevel ("LoadScene");			break;		case GameScene.SCENE_BASTION:			Application.LoadLevel ("BastionScene");			break;		case GameScene.SCENE_BATTLE:			Application.LoadLevel ("BattleScene");			break;		case GameScene.SCENE_WORLDMAP:			Application.LoadLevel ("WorldMapScene");			Destroy(gm.GetComponent<InitScene>());			gm.AddComponent<WorldMapScene>();			gm.AddComponent<BastionManager>();			gm.AddComponent<MapManager>();			break;		}	}	public void OnLocationUpdate(string data) {		Debug.Log ("OnLocationUpdate:"+data);				JsonData jdata = JsonMapper.ToObject (data);		Location location = new Location (jdata);		gm.SendMessage ("RefreshBastion", location);		gm.SendMessage ("RefreshMap", location);	}}